''=======================================================================================
''Unifloc 7.27a primavera                                          khabibullinra@gmail.com
''Petroleum engineering calculations modules (macroses)
''2000 - 2021
''
''=======================================================================================
'' функции расчета скважины дл€ проведени€ расчетов из интерфейса Excel
'
'Option Explicit
'
'description_to_manual      - дл€ автогенерации описани€ - помещает заголовок функции и окружающие комментарии в мануал (со след строки)
' расчет натуральной сепарации газа на приеме насоса
Public Function well_ksep_natural_d( _
             ByVal q_liq_sm3day As Double, _
             ByVal fw_perc As Double, _
             ByVal p_intake_atma As Double, _
    Optional ByVal t_intake_C As Double = 50, _
    Optional ByVal d_intake_mm As Double = 90, _
    Optional ByVal d_cas_mm As Double = 120, _
    Optional ByVal str_PVT As String = PVT_DEFAULT)
' q_liq_sm3day   - дебит жидкости в поверхностных услови€х
' fw_perc       - обводненность
' p_intake_atma - давление сепарации
' t_intake_C    - температура сепарации
' d_intake_mm   - диаметр приемной сетки
' d_cas_mm      - диаметр эксплуатационной колонны
' str_PVT       - закодированна€ строка с параметрами PVT.
'                 если задана - перекрывает другие значени€
' результат     - число - естественна€ сепараци€
'description_end
On Error GoTo err1:
    Dim fluid As New CPVT
    Call fluid.init_feed(str_PVT)
    fluid.q_liq_sm3day = q_liq_sm3day
    fluid.fw_perc = fw_perc
    Call fluid.calc_PVT(p_intake_atma, t_intake_C)
    With fluid
        well_ksep_natural_d = unf_natural_separation(d_intake_mm / 1000, d_cas_mm / 1000, .q_liq_sm3day, .q_gas_sm3day, .bo_m3m3, .bg_m3m3, _
                                                    .sigma_oil_gas_Nm, .sigma_wat_gas_Nm, .rho_oil_sckgm3, .rho_gas_sckgm3, .fw_perc)
    End With
    Exit Function
err1:
    MF_ksep_natural_d = -1
    add_log_msg "Error:MF_ksep_natural_d:" & Err.Description
End Function
'description_to_manual      - дл€ автогенерации описани€ - помещает заголовок функции и окружающие комментарии в мануал (со след строки)
' расчет общей сепарации на приеме насоса
Public Function well_ksep_total_d( _
        ByVal SepNat As Double, _
        ByVal SepGasSep As Double)
' SepNat        - естественна€ сепараци€
' SepGasSep     - искусственна€ сепараци€ (газосепаратор)
    well_ksep_total_d = SepNat + (1 - SepNat) * SepGasSep
End Function
'description_end

