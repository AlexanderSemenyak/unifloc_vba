'=======================================================================================
'Unifloc 7.36 winter jet                                     khabibullinra@gmail.com
'Petroleum engineering calculations modules (macroses)
'2000 - 2022
'
'=======================================================================================
'
' general functions providing logging capabilities in all classess and modules
'  log messages accululated in ln CLogger object and can be saved in file
'
Option Explicit
Dim lm As New CLogger           ' лог который накапливает все сообщения. поддерживает сохранение сообщений в файл
Private Function MakeLogMsg(msg, Optional msg1, Optional msg2, Optional msg3) As String
 Dim msg_str As String
 msg_str = Format(Date, "Short Date") & " : " & Format(Time, "Long Time") & " : " & sDELIM
 
 If Not IsMissing(msg) Then
    msg_str = msg_str & msg
 End If
 If Not IsMissing(msg1) Then
    msg_str = msg_str & " : " & msg1
 End If
 If Not IsMissing(msg2) Then
    msg_str = msg_str & " : " & msg2
 End If
 If Not IsMissing(msg3) Then
    msg_str = msg_str & " : " & msg3
 End If
 Debug.Print msg_str                                        '   пишем в окно отладки
 MakeLogMsg = msg_str          '  сохраняем строку
End Function
Public Function add_log_msg(msg As String, Optional msg1, Optional msg2, Optional msg3)
' вывод сообщения в лог и в окно отладки
' можно задать до 3 строк, которые автоматически склеиваются в одну перед выводом
 lm.add_msg MakeLogMsg(msg, msg1, msg2, msg3)          '  пишем в лог
End Function
Public Function getLogObject() As CLogger
  Set getLogObject = lm
End Function

